# План создания Express.js сервера для парсинга торрент-файлов

## Этап 1: Инициализация проекта

### 1.1 Создание package.json
- [x] Инициализация npm проекта
- [x] Добавление зависимостей: express, cheerio, axios, dotenv

### 1.2 Установка зависимостей
- [x] Выполнить `npm install` для установки всех зависимостей

## Этап 2: Структура проекта

### 2.1 Создание структуры папок
```
ServerParsing/
├── src/
│   ├── server.js          # Главный файл сервера
│   ├── routes/
│   │   └── torrent.js     # Роуты для работы с торрентами
│   ├── services/
│   │   └── parser.js       # Логика парсинга торрентов
│   └── utils/
│       └── helpers.js      # Вспомогательные функции
├── .env                    # Переменные окружения
├── .gitignore
├── package.json
└── README.md
```

### 2.2 Создание базовых файлов
- [x] `.gitignore` - исключения для git
- [ ] `.env` - шаблон переменных окружения
- [x] `README.md` - документация проекта

## Этап 3: Основной функционал

### 3.1 Настройка Express сервера
- [ ] Создание базового Express приложения
- [ ] Настройка middleware (JSON parser, error handler)
- [ ] Настройка порта из переменных окружения

### 3.2 Создание API endpoints
- [ ] `GET /api/parse` - основной endpoint для парсинга
  - [ ] Параметры: `url` (URL сайта для парсинга)
  - [ ] Возвращает: JSON с результатами парсинга
- [ ] `GET /api/health` - проверка работоспособности сервера

### 3.3 Модуль парсинга (services/parser.js)
- [ ] Функция получения HTML страницы
- [ ] Функция извлечения ссылок на торрент-файлы
- [ ] Функция скачивания .torrent файлов
- [ ] Функция обработки и парсинга торрент-файлов
- [ ] Возврат метаданных (название, размер, хеш, трекеры и т.д.)

### 3.4 Вспомогательные функции (utils/helpers.js)
- [ ] Валидация URL
- [ ] Обработка ошибок
- [ ] Форматирование данных
- [ ] Утилиты для работы с файлами

## Этап 4: Обработка ошибок и безопасность

### 4.1 Обработка ошибок
- [ ] Централизованный error handler
- [ ] Валидация входных данных
- [ ] Обработка сетевых ошибок
- [ ] Логирование ошибок

### 4.2 Безопасность
- [ ] Валидация URL (защита от SSRF)
- [ ] Санитизация входных данных

## Этап 5: Тестирование

### 5.1 Ручное тестирование
- [ ] Тестирование основных endpoints
- [ ] Проверка обработки ошибок
- [ ] Тестирование с различными сайтами

### 5.2 Оптимизация
- [ ] Оптимизация запросов
- [ ] Обработка больших файлов

## Вопросы для уточнения

1. **Какой сайт парсить?**
   - Нужны примеры URL и структура страниц
   
   - Требуется ли авторизация?

2. **Что именно извлекать?**
   - Ссылки на .torrent файлы
   - Метаданные торрентов
   - Списки раздач
   - Дополнительная информация (размер, дата, сиды/пиры)

3. **Формат ответа API:**
   - JSON структура
   - Какие поля включать

4. **Обработка торрент-файлов:**
   - Только ссылки или скачивание файлов
   - Парсинг содержимого .torrent файлов
   - Извлечение метаданных
